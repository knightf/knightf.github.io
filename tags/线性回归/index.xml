<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>çº¿æ€§å›å½’ on éŸ©é£çš„åšå®¢</title>
    <link>https://knightf.coding.me/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/index.xml</link>
    <description>Recent content in çº¿æ€§å›å½’ on éŸ©é£çš„åšå®¢</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <atom:link href="https://knightf.coding.me/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>æœºå™¨å­¦ä¹  ç¬¬ä¸€ç«  çº¿æ€§å›å½’</title>
      <link>https://knightf.coding.me/post/linear-regression/</link>
      <pubDate>Fri, 17 Feb 2017 17:22:16 +0800</pubDate>
      
      <guid>https://knightf.coding.me/post/linear-regression/</guid>
      <description>

&lt;p&gt;å¯¹äºç”± &lt;code&gt;$m$&lt;/code&gt; ä¸ª &lt;code&gt;$n$&lt;/code&gt; ç»´çš„ç‰¹å¾å‘é‡ &lt;code&gt;$x_n$&lt;/code&gt; æ„æˆçš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¸Œæœ›æ±‚å¾—ä¸€ä¸ªå‡½æ•°å½¢å¦‚ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$h_\theta(x)=\theta_0+\theta_1x_1+\cdots+\theta_nx_n$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æ¥ååº”ç‰¹å¾å‘é‡ &lt;code&gt;$x_n$&lt;/code&gt; ä¸å…¶å¯¹åº”ç»“æœ &lt;code&gt;$y_n$&lt;/code&gt; çš„å…³ç³»ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„ä¹¦å†™ï¼Œé»˜è®¤ &lt;code&gt;$x_0=1$&lt;/code&gt;ï¼Œæœ‰ğŸ‘‡å¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$h(x)=\sum_{i=0}^n\theta_ix_i=\theta^Tx$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ° &lt;code&gt;$\theta$&lt;/code&gt; ä¸ &lt;code&gt;$x$&lt;/code&gt; ç°åœ¨éƒ½æ˜¯é•¿åº¦ä¸º &lt;code&gt;$n+1$&lt;/code&gt; çš„å‘é‡ã€‚&lt;/p&gt;

&lt;p&gt;æ­¤å¤„æˆ‘ä»¬å®šä¹‰ &lt;code&gt;æˆæœ¬å‡½æ•°&lt;/code&gt; (cost function) å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$J(\theta)=\frac{1}{2}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2$$&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&#34;æ¢¯åº¦ä¸‹é™&#34;&gt;æ¢¯åº¦ä¸‹é™&lt;/h1&gt;

&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬ç°åœ¨éœ€è¦ç¡®å®š &lt;code&gt;$\theta$&lt;/code&gt; çš„å€¼æ¥è®© &lt;code&gt;$J(\theta)$&lt;/code&gt; å–åˆ°æœ€å°å€¼ã€‚é‡‡ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä¸æ–­æ›´æ–° &lt;code&gt;$\theta$&lt;/code&gt; çš„å€¼ç›´åˆ°æ”¶æ•›ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\theta_j:=\theta_j-\alpha\frac{\partial}{\partial\theta_j}J(\theta)$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æ­¤å¤„ &lt;code&gt;$\alpha$&lt;/code&gt; è¢«ç§°ä½œ &lt;code&gt;å­¦ä¹ é€Ÿç‡&lt;/code&gt; ã€‚æŠŠ &lt;code&gt;$J(\theta)$&lt;/code&gt; å¸¦å…¥ğŸ‘†çš„å¼å­å¹¶æ±‚è§£åå¾®åˆ†åå¾—åˆ°æ›´æ–° &lt;code&gt;$\theta$&lt;/code&gt; çš„è§„åˆ™å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\theta_j:=\theta_j+\alpha(y^{(i)}-h_\theta(x^{(i)}))x_j^{(i)}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿™è¢«ç§°ä½œ &lt;code&gt;LMS&lt;/code&gt; (least mean squares) æ›´æ–°è§„åˆ™ã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç®—æ³•å°±å¯ä»¥è¿™æ ·å†™ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ç›´åˆ°æ”¶æ•› {&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;å¯¹æ¯ä¸€ä¸ª j&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$\theta_j:=\theta_j+\alpha\sum_{i=1}^m(y^{(i)}-h_\theta(x^{(i)}))x_j^{(i)}$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿™ç§æ–¹æ³•å«åš &lt;code&gt;æ‰¹é‡æ¢¯åº¦ä¸‹é™&lt;/code&gt; (batch gradient descent) ã€‚ä¸ä¹‹å¯¹åº”ï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;å¾ªç¯ {&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;i ä» 1 å¾ªç¯è‡³ m&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;å¯¹æ¯ä¸€ä¸ª j&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$\theta_j:=\theta_j+\alpha(y^{(i)}-h_\theta(x^{(i)}))x_j^{(i)}$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™ç§æ–¹æ³•æ¯å¤„ç†ä¸€æ¡è®­ç»ƒé›†ä¸­çš„æ ·æœ¬æ—¶ï¼Œæˆ‘ä»¬åªæ ¹æ®å½“å‰æ ·æœ¬è¯¯å·®åšäº†è®¡ç®—å¹¶æ›´æ–°ã€‚è¿™ç§æ–¹æ³•å«åš &lt;code&gt;éšæœºæ¢¯åº¦ä¸‹é™&lt;/code&gt; (stochastic gradient descent) ã€‚&lt;/p&gt;

&lt;h1 id=&#34;å¸¸è§„æ–¹ç¨‹&#34;&gt;å¸¸è§„æ–¹ç¨‹&lt;/h1&gt;

&lt;p&gt;é™¤äº†é‡‡ç”¨æ¢¯åº¦ä¸‹é™è¿™ç§è¿­ä»£ç®—æ³•æ¥æœ€å°åŒ– &lt;code&gt;$J$&lt;/code&gt; ï¼Œè¿˜å¯ä»¥ç›´æ¥ç”¨ä»£æ•°è®¡ç®—å‡ºå€¼ã€‚æˆ‘ä»¬å®šä¹‰ &lt;code&gt;è®¾è®¡çŸ©é˜µ&lt;/code&gt; &lt;code&gt;$X$&lt;/code&gt; ä¸º m è¡Œ n åˆ—çš„çŸ©é˜µã€‚ &lt;code&gt;$X$&lt;/code&gt; çš„æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªæ ·æœ¬æ‰€æœ‰ç‰¹å¾çš„è½¬ç½®ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$X=\begin{bmatrix}(x^{(1)})^T\\(x^{(2)})^T\\\vdots\\(x^{(m)})^T\end{bmatrix}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;åŒæ ·çš„æˆ‘ä»¬å®šä¹‰ &lt;code&gt;$\vec y$&lt;/code&gt; æ˜¯åŒ…å«å¯¹åº”æ‰€æœ‰æ ·æœ¬çš„ç»“æœé›†ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\vec y=\begin{bmatrix}y^{(1)}\\y^{(2)}\\\vdots\\y^{(m)}\end{bmatrix}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‘ç° &lt;code&gt;$X, \vec y$&lt;/code&gt; ä¸ &lt;code&gt;$J(\theta)$&lt;/code&gt; ä¹‹é—´çš„å…³ç³»ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\begin{eqnarray}
\frac{1}{2}(X\theta-\vec y)^T(X\theta-\vec y) &amp;amp;=&amp;amp; \frac{1}{2}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2 \\
&amp;amp;=&amp;amp; J(\theta)
\end{eqnarray}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿›è€Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å¾— &lt;code&gt;$J(\theta)$&lt;/code&gt; çš„åå¾®åˆ†å‘é‡ä¸ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\begin{eqnarray}
\nabla J(\theta) &amp;amp;=&amp;amp; \nabla_\theta\frac{1}{2}(X\theta-\vec y)^T(X\theta-\vec y) \\
&amp;amp;=&amp;amp; X^TX\theta-X^T\vec y
\end{eqnarray}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœä»¤ &lt;code&gt;$J$&lt;/code&gt; å–æœ€å°å€¼ï¼Œåˆ™ä»¤åå¾®åˆ†å‘é‡ä¸ºé›¶ï¼Œå¾—åˆ°äº† &lt;code&gt;å¸¸è§„æ–¹ç¨‹&lt;/code&gt; (normal equations) ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$X^TX\theta=X^T\vec y$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ±‚å¾— &lt;code&gt;$\theta$&lt;/code&gt; äº†ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\theta=(X^TX)^{-1}X^T\vec y$$&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&#34;æ¦‚ç‡å­¦è§£é‡Š&#34;&gt;æ¦‚ç‡å­¦è§£é‡Š&lt;/h1&gt;

&lt;p&gt;ä¸Šé¢æˆ‘ä»¬ç›´æ¥ç»™å®šäº† &lt;code&gt;æˆæœ¬å‡½æ•°&lt;/code&gt; &lt;code&gt;$J$&lt;/code&gt; çš„å½¢å¼ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆç”¨ä¸Šé¢ç»™å‡ºçš„å½¢å¼å°±æ˜¯æœ€å¥½çš„è¡¡é‡æ–¹å¼å‘¢ï¼Ÿæˆ‘ä»¬å…ˆå‡è®¾æ ·æœ¬ã€è¯¯å·®å’Œç»“æœä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$y^{(i)}=\theta^Tx^{(i)}+\epsilon^{(i)}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­ &lt;code&gt;$\epsilon^{(i)}$&lt;/code&gt; ä»£è¡¨æ¨¡å‹ç»™å‡ºçš„é¢„æµ‹å€¼ä¸å®é™…å€¼çš„è¯¯å·®ï¼Œä¸è®ºæ˜¯ç”±æ²¡èƒ½æŠ“ä½ç‰¹å¾å¼•èµ·çš„ï¼Œè¿˜æ˜¯å°±æ˜¯éšæœºçš„å™ªå£°è¯¯å·®ã€‚æˆ‘ä»¬å†å‡è®¾ &lt;code&gt;$\epsilon^{(i)}\sim\mathcal{N}(0,\sigma^2)$&lt;/code&gt;ï¼Œæ¦‚ç‡ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$p(\epsilon^{(i)})=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(\epsilon^{(i)})^2}{2\sigma^2})$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¿™å°±è¯´æ˜ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$p(y^{(i)}|x^{(i)};\theta)=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2})$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬ç°åœ¨å…³å¿ƒçš„æ˜¯ &lt;code&gt;$\theta$&lt;/code&gt; è¿™ä¸ªå˜é‡ï¼Œå› ä¸ºæ±‚å‡è®¾å‡½æ•° &lt;code&gt;$h_\theta$&lt;/code&gt; çš„è¿‡ç¨‹å…¶å®å°±æ˜¯æ±‚å‡º &lt;code&gt;$\theta$&lt;/code&gt; çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å¸Œæœ›å¯ä»¥æ„é€ ä¸€ä¸ªå‡½æ•°ä½¿ &lt;code&gt;$\theta$&lt;/code&gt; æˆä¸ºè‡ªå˜é‡ï¼Œç„¶åæŠŠå®ƒå«åš &lt;code&gt;ä¼¼ç„¶å‡½æ•°&lt;/code&gt; ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$L(\theta)=L(\theta;X,\vec y)=p(\vec y|X; \theta)$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ç”±è¯¯å·®æ˜¯ç‹¬ç«‹çš„è¿™ä¸€å‡è®¾æˆ‘ä»¬å¯ä»¥ç»™å‡ºä¸‹é¢çš„å¼å­ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\begin{eqnarray}
L(\theta) &amp;amp;=&amp;amp; \prod_{i=1}^mp(y^{(i)}|x^{(i)};\theta) \\
&amp;amp;=&amp;amp; \prod_{i=1}^m\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2})
\end{eqnarray}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ç”±æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„åŸç†æˆ‘ä»¬çŸ¥é“åº”è¯¥æ‰¾åˆ°ä½¿å‡½æ•° &lt;code&gt;$L(\theta)$&lt;/code&gt; çš„ &lt;code&gt;$\theta$&lt;/code&gt; çš„å€¼ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦å¯¹å‡½æ•°æ±‚å¯¼ã€‚ä¸ºäº†ç®€åŒ–æ±‚å¯¼çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;å¯¹æ•°ä¼¼ç„¶å‡½æ•°&lt;/code&gt; ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\begin{eqnarray}
\mathcal{l}(\theta) &amp;amp;=&amp;amp; \log L(\theta) \\
&amp;amp;=&amp;amp; \log\prod_{i=1}^m\frac{1}{\sqrt{2\pi}\sigma}exp(\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2}) \\
&amp;amp;=&amp;amp; \sum_{i=1}^m\log\frac{1}{\sqrt{2\pi}\sigma}exp(\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2}) \\
&amp;amp;=&amp;amp; m\log\frac{1}{\sqrt{2\pi}\sigma}-\frac{1}{\sigma^2}\centerdot\frac{1}{2}\sum_{i=1}^{m}(y^{(i)}-\theta^Tx^{(i)})^2
\end{eqnarray}$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å°±å¯ä»¥è§‚å¯Ÿå¾—åˆ°æˆ‘ä»¬æ±‚ &lt;code&gt;$\mathcal{l}(\theta)$&lt;/code&gt; çš„æœ€å¤§å€¼å…¶å®å°±æ˜¯æ±‚ä¸‹é¢å¼å­çš„æœ€å°å€¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$\frac{1}{2}\sum_{i=1}^m(y^{(i)}-\theta^Tx^{(i)})^2$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹æå‡ºçš„å‡½æ•° &lt;code&gt;$J(\theta)$&lt;/code&gt; ã€‚&lt;/p&gt;

&lt;h1 id=&#34;å°±è¿‘æƒé‡çº¿æ€§å›å½’&#34;&gt;å°±è¿‘æƒé‡çº¿æ€§å›å½’&lt;/h1&gt;

&lt;p&gt;åœ¨ä¸Šé¢æå‡ºçš„åŸå§‹çš„çº¿æ€§å›å½’ç®—æ³•ä¸­ï¼Œå¦‚æœè¦æƒ³å¯¹æŸä¸ªç‚¹ &lt;code&gt;$x$&lt;/code&gt; ä½œå‡ºé¢„æµ‹ï¼Œæˆ‘ä»¬è¿™ä¹ˆåšï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æ‰¾åˆ°ä½¿ &lt;code&gt;$\sum_i(y^{(i)}-\theta^Tx^{(i)})^2$&lt;/code&gt; å–å¾—æœ€å°å€¼çš„ &lt;code&gt;$\theta$&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;li&gt;è¾“å‡º &lt;code&gt;$\theta^Tx$&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¸åŒçš„æ˜¯ï¼Œå°±è¿‘æƒé‡çº¿æ€§å›å½’ç®—æ³•è¿™ä¹ˆåšï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æ‰¾åˆ°ä½¿ &lt;code&gt;$\sum_iw^{(i)}(y^{(i)}-\theta^Tx^{(i)})^2$&lt;/code&gt; å–å¾—æœ€å°å€¼çš„ &lt;code&gt;$\theta$&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;li&gt;è¾“å‡º &lt;code&gt;$\theta^Tx$&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™é‡Œçš„ &lt;code&gt;$w^{(i)}$&lt;/code&gt; æ˜¯ä¸€ç»„éè´Ÿæ•°çš„ &lt;code&gt;æƒé‡&lt;/code&gt; ã€‚å¦‚æœå¯¹æŸ &lt;code&gt;$i$&lt;/code&gt; è€Œè¨€ &lt;code&gt;$w^{(i)}$&lt;/code&gt; çš„å€¼å¾ˆå¤§ï¼Œé‚£ä¹ˆåœ¨è®¡ç®— &lt;code&gt;$\theta$&lt;/code&gt; çš„æ—¶å€™è¿™ä¸€é¡¹å çš„æˆåˆ†å°±å¾ˆå¤§ï¼Œåä¹‹åˆ™ä¼šå¯¹ &lt;code&gt;$\theta$&lt;/code&gt; çš„å½±å“å°±ä¼šå¾ˆå°ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒæ ‡å‡†çš„é€‰æ‹©æƒé‡çš„å‡½æ•°æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code&gt;$$w^{(i)}=\exp(-\frac{(x^{(i)}-x)^2}{2\tau^2})$$&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­çš„ &lt;code&gt;$\tau$&lt;/code&gt; æ§åˆ¶äº†é‡è¦æƒé‡çš„èŒƒå›´ï¼Œæ‰€ä»¥å«åš &lt;code&gt;å¸¦å®½&lt;/code&gt; (bandwidth) å‚æ•°ï¼Œé€šå¸¸é€šè¿‡å®éªŒå¾—å‡ºã€‚&lt;/p&gt;

&lt;p&gt;å°±è¿‘æƒé‡çº¿æ€§å›å½’æ˜¯ä¸€ç§ &lt;code&gt;éå‚æ•°ç®—æ³•&lt;/code&gt; ï¼Œè€Œæ™®é€šçš„çº¿æ€§å›å½’æ˜¯ä¸€ç§ &lt;code&gt;å‚æ•°ç®—æ³•&lt;/code&gt; ã€‚å‰è€…ä¸å­˜å‚¨ &lt;code&gt;$\theta$&lt;/code&gt; çš„å€¼ï¼Œè€Œæ˜¯æ¯æ¬¡é¢„æµ‹æ—¶éƒ½è¦è®¡ç®—ï¼Œåè€…åˆ™æ˜¯åªè®¡ç®—ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
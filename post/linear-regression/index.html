    <!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="éŸ©é£">
    
    <meta name="generator" content="Hugo 0.18.1" />
    <title>æœºå™¨å­¦ä¹  ç¬¬ä¸€ç«  çº¿æ€§å›å½’ &middot; éŸ©é£çš„åšå®¢</title>
    <link rel="shortcut icon" href="https://knightf.github.io/images/favicon.ico">
    <link rel="stylesheet" href="https://knightf.github.io/css/style.css">
    <link rel="stylesheet" href="https://knightf.github.io/css/highlight.css">
    

    
    <link rel="stylesheet" href="https://knightf.github.io/css/monosocialiconsfont.css">
    

    

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [['$','$'], ['\\(','\\)']],
          displayMath: [['$$','$$'], ['\[','\]']],
          processEscapes: true,
          processEnvironments: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
          TeX: { equationNumbers: { autoNumber: "AMS" },
               extensions: ["AMSmath.js", "AMSsymbols.js"] }
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
          
          
          
          var all = MathJax.Hub.getAllJax(), i;
          for(i = 0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });
    </script>
  </head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://knightf.github.io/'> <span class="arrow">â†</span>Home</a>
	

	
		
	

	
</nav>

        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>æœºå™¨å­¦ä¹  ç¬¬ä¸€ç«  çº¿æ€§å›å½’</h1>
                    <h2 class="headline">
                    February 17, 2017 
                    <br>
                    
                    
                        
                            <a href="https://knightf.github.io/tags/machine-learning">Machine Learning</a>
                        
                            <a href="https://knightf.github.io/tags/stanford-cs229">Stanford CS229</a>
                        
                    
                    
                    </h2>
                </header>
                <section id="post-body">
                    

<p>å¯¹äºç”± <code>$m$</code> ä¸ª <code>$n$</code> ç»´çš„ç‰¹å¾å‘é‡ <code>$x_n$</code> æ„æˆçš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¸Œæœ›æ±‚å¾—ä¸€ä¸ªå‡½æ•°å½¢å¦‚ï¼š</p>

<p><code>$$h_\theta(x)=\theta_0+\theta_1x_1+\cdots+\theta_nx_n$$</code></p>

<p>æ¥ååº”ç‰¹å¾å‘é‡ <code>$x_n$</code> ä¸å…¶å¯¹åº”ç»“æœ <code>$y_n$</code> çš„å…³ç³»ã€‚</p>

<p>ä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„ä¹¦å†™ï¼Œé»˜è®¤ <code>$x_0=1$</code>ï¼Œæœ‰ğŸ‘‡å¼ï¼š</p>

<p><code>$$h(x)=\sum_{i=0}^n\theta_ix_i=\theta^Tx$$</code></p>

<p>å¯ä»¥çœ‹åˆ° <code>$\theta$</code> ä¸ <code>$x$</code> ç°åœ¨éƒ½æ˜¯é•¿åº¦ä¸º <code>$n+1$</code> çš„å‘é‡ã€‚</p>

<p>æ­¤å¤„æˆ‘ä»¬å®šä¹‰ <code>æˆæœ¬å‡½æ•°</code> (cost function) å¦‚ä¸‹ï¼š</p>

<p><code>$$J(\theta)=\frac{1}{2}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2$$</code></p>

<h1 id="æ¢¯åº¦ä¸‹é™">æ¢¯åº¦ä¸‹é™</h1>

<p>æ‰€ä»¥æˆ‘ä»¬ç°åœ¨éœ€è¦ç¡®å®š <code>$\theta$</code> çš„å€¼æ¥è®© <code>$J(\theta)$</code> å–åˆ°æœ€å°å€¼ã€‚é‡‡ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä¸æ–­æ›´æ–° <code>$\theta$</code> çš„å€¼ç›´åˆ°æ”¶æ•›ï¼š</p>

<p><code>$$\theta_j:=\theta_j-\alpha\frac{\partial}{\partial\theta_j}J(\theta)$$</code></p>

<p>æ­¤å¤„ <code>$\alpha$</code> è¢«ç§°ä½œ <code>å­¦ä¹ é€Ÿç‡</code> ã€‚æŠŠ <code>$J(\theta)$</code> å¸¦å…¥ğŸ‘†çš„å¼å­å¹¶æ±‚è§£åå¾®åˆ†åå¾—åˆ°æ›´æ–° <code>$\theta$</code> çš„è§„åˆ™å¦‚ä¸‹ï¼š</p>

<p><code>$$\theta_j:=\theta_j+\alpha(y^{(i)}-h_\theta(x^{(i)}))x_j^{(i)}$$</code></p>

<p>è¿™è¢«ç§°ä½œ <code>LMS</code> (least mean squares) æ›´æ–°è§„åˆ™ã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç®—æ³•å°±å¯ä»¥è¿™æ ·å†™ï¼š</p>

<p><code>ç›´åˆ°æ”¶æ•› {</code></p>

<p><code>å¯¹æ¯ä¸€ä¸ª j</code></p>

<p><code>$\theta_j:=\theta_j+\alpha\sum_{i=1}^m(y^{(i)}-h_\theta(x^{(i)}))x_j^{(i)}$</code></p>

<p><code>}</code></p>

<p>è¿™ç§æ–¹æ³•å«åš <code>æ‰¹é‡æ¢¯åº¦ä¸‹é™</code> (batch gradient descent) ã€‚ä¸ä¹‹å¯¹åº”ï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>

<p><code>å¾ªç¯ {</code></p>

<p><code>i ä» 1 å¾ªç¯è‡³ m</code></p>

<p><code>å¯¹æ¯ä¸€ä¸ª j</code></p>

<p><code>$\theta_j:=\theta_j+\alpha(y^{(i)}-h_\theta(x^{(i)}))x_j^{(i)}$</code></p>

<p><code>}</code></p>

<p>å¯ä»¥çœ‹åˆ°è¿™ç§æ–¹æ³•æ¯å¤„ç†ä¸€æ¡è®­ç»ƒé›†ä¸­çš„æ ·æœ¬æ—¶ï¼Œæˆ‘ä»¬åªæ ¹æ®å½“å‰æ ·æœ¬è¯¯å·®åšäº†è®¡ç®—å¹¶æ›´æ–°ã€‚è¿™ç§æ–¹æ³•å«åš <code>éšæœºæ¢¯åº¦ä¸‹é™</code> (stochastic gradient descent) ã€‚</p>

<h1 id="å¸¸è§„æ–¹ç¨‹">å¸¸è§„æ–¹ç¨‹</h1>

<p>é™¤äº†é‡‡ç”¨æ¢¯åº¦ä¸‹é™è¿™ç§è¿­ä»£ç®—æ³•æ¥æœ€å°åŒ– <code>$J$</code> ï¼Œè¿˜å¯ä»¥ç›´æ¥ç”¨ä»£æ•°è®¡ç®—å‡ºå€¼ã€‚æˆ‘ä»¬å®šä¹‰ <code>è®¾è®¡çŸ©é˜µ</code> <code>$X$</code> ä¸º m è¡Œ n åˆ—çš„çŸ©é˜µã€‚ <code>$X$</code> çš„æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªæ ·æœ¬æ‰€æœ‰ç‰¹å¾çš„è½¬ç½®ï¼š</p>

<p><code>$$X=\begin{bmatrix}(x^{(1)})^T\\(x^{(2)})^T\\\vdots\\(x^{(m)})^T\end{bmatrix}$$</code></p>

<p>åŒæ ·çš„æˆ‘ä»¬å®šä¹‰ <code>$\vec y$</code> æ˜¯åŒ…å«å¯¹åº”æ‰€æœ‰æ ·æœ¬çš„ç»“æœé›†ï¼š</p>

<p><code>$$\vec y=\begin{bmatrix}y^{(1)}\\y^{(2)}\\\vdots\\y^{(m)}\end{bmatrix}$$</code></p>

<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‘ç° <code>$X, \vec y$</code> ä¸ <code>$J(\theta)$</code> ä¹‹é—´çš„å…³ç³»ï¼š</p>

<p><code>$$\begin{eqnarray}
\frac{1}{2}(X\theta-\vec y)^T(X\theta-\vec y) &amp;=&amp; \frac{1}{2}\sum_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2 \\
&amp;=&amp; J(\theta)
\end{eqnarray}$$</code></p>

<p>è¿›è€Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å¾— <code>$J(\theta)$</code> çš„åå¾®åˆ†å‘é‡ä¸ºï¼š</p>

<p><code>$$\begin{eqnarray}
\nabla J(\theta) &amp;=&amp; \nabla_\theta\frac{1}{2}(X\theta-\vec y)^T(X\theta-\vec y) \\
&amp;=&amp; X^TX\theta-X^T\vec y
\end{eqnarray}$$</code></p>

<p>å¦‚æœä»¤ <code>$J$</code> å–æœ€å°å€¼ï¼Œåˆ™ä»¤åå¾®åˆ†å‘é‡ä¸ºé›¶ï¼Œå¾—åˆ°äº† <code>å¸¸è§„æ–¹ç¨‹</code> (normal equations) ï¼š</p>

<p><code>$$X^TX\theta=X^T\vec y$$</code></p>

<p>æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ±‚å¾— <code>$\theta$</code> äº†ï¼š</p>

<p><code>$$\theta=(X^TX)^{-1}X^T\vec y$$</code></p>

<h1 id="æ¦‚ç‡å­¦è§£é‡Š">æ¦‚ç‡å­¦è§£é‡Š</h1>

<p>ä¸Šé¢æˆ‘ä»¬ç›´æ¥ç»™å®šäº† <code>æˆæœ¬å‡½æ•°</code> <code>$J$</code> çš„å½¢å¼ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆç”¨ä¸Šé¢ç»™å‡ºçš„å½¢å¼å°±æ˜¯æœ€å¥½çš„è¡¡é‡æ–¹å¼å‘¢ï¼Ÿæˆ‘ä»¬å…ˆå‡è®¾æ ·æœ¬ã€è¯¯å·®å’Œç»“æœä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š</p>

<p><code>$$y^{(i)}=\theta^Tx^{(i)}+\epsilon^{(i)}$$</code></p>

<p>å…¶ä¸­ <code>$\epsilon^{(i)}$</code> ä»£è¡¨æ¨¡å‹ç»™å‡ºçš„é¢„æµ‹å€¼ä¸å®é™…å€¼çš„è¯¯å·®ï¼Œä¸è®ºæ˜¯ç”±æ²¡èƒ½æŠ“ä½ç‰¹å¾å¼•èµ·çš„ï¼Œè¿˜æ˜¯å°±æ˜¯éšæœºçš„å™ªå£°è¯¯å·®ã€‚æˆ‘ä»¬å†å‡è®¾ <code>$\epsilon^{(i)}\sim\mathcal{N}(0,\sigma^2)$</code>ï¼Œæ¦‚ç‡ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼š</p>

<p><code>$$p(\epsilon^{(i)})=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(\epsilon^{(i)})^2}{2\sigma^2})$$</code></p>

<p>è¿™å°±è¯´æ˜ï¼š</p>

<p><code>$$p(y^{(i)}|x^{(i)};\theta)=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2})$$</code></p>

<p>ä½†æ˜¯æˆ‘ä»¬ç°åœ¨å…³å¿ƒçš„æ˜¯ <code>$\theta$</code> è¿™ä¸ªå˜é‡ï¼Œå› ä¸ºæ±‚å‡è®¾å‡½æ•° <code>$h_\theta$</code> çš„è¿‡ç¨‹å…¶å®å°±æ˜¯æ±‚å‡º <code>$\theta$</code> çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å¸Œæœ›å¯ä»¥æ„é€ ä¸€ä¸ªå‡½æ•°ä½¿ <code>$\theta$</code> æˆä¸ºè‡ªå˜é‡ï¼Œç„¶åæŠŠå®ƒå«åš <code>ä¼¼ç„¶å‡½æ•°</code> ï¼š</p>

<p><code>$$L(\theta)=L(\theta;X,\vec y)=p(\vec y|X; \theta)$$</code></p>

<p>ç”±è¯¯å·®æ˜¯ç‹¬ç«‹çš„è¿™ä¸€å‡è®¾æˆ‘ä»¬å¯ä»¥ç»™å‡ºä¸‹é¢çš„å¼å­ï¼š</p>

<p><code>$$\begin{eqnarray}
L(\theta) &amp;=&amp; \prod_{i=1}^mp(y^{(i)}|x^{(i)};\theta) \\
&amp;=&amp; \prod_{i=1}^m\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2})
\end{eqnarray}$$</code></p>

<p>ç”±æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„åŸç†æˆ‘ä»¬çŸ¥é“åº”è¯¥æ‰¾åˆ°ä½¿å‡½æ•° <code>$L(\theta)$</code> çš„ <code>$\theta$</code> çš„å€¼ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦å¯¹å‡½æ•°æ±‚å¯¼ã€‚ä¸ºäº†ç®€åŒ–æ±‚å¯¼çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>å¯¹æ•°ä¼¼ç„¶å‡½æ•°</code> ï¼š</p>

<p><code>$$\begin{eqnarray}
\mathcal{l}(\theta) &amp;=&amp; \log L(\theta) \\
&amp;=&amp; \log\prod_{i=1}^m\frac{1}{\sqrt{2\pi}\sigma}exp(\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2}) \\
&amp;=&amp; \sum_{i=1}^m\log\frac{1}{\sqrt{2\pi}\sigma}exp(\frac{(y^{(i)}-\theta^Tx^{(i)})^2}{2\sigma^2}) \\
&amp;=&amp; m\log\frac{1}{\sqrt{2\pi}\sigma}-\frac{1}{\sigma^2}\centerdot\frac{1}{2}\sum_{i=1}^{m}(y^{(i)}-\theta^Tx^{(i)})^2
\end{eqnarray}$$</code></p>

<p>å°±å¯ä»¥è§‚å¯Ÿå¾—åˆ°æˆ‘ä»¬æ±‚ <code>$\mathcal{l}(\theta)$</code> çš„æœ€å¤§å€¼å…¶å®å°±æ˜¯æ±‚ä¸‹é¢å¼å­çš„æœ€å°å€¼ï¼š</p>

<p><code>$$\frac{1}{2}\sum_{i=1}^m(y^{(i)}-\theta^Tx^{(i)})^2$$</code></p>

<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹æå‡ºçš„å‡½æ•° <code>$J(\theta)$</code> ã€‚</p>

<h1 id="å°±è¿‘æƒé‡çº¿æ€§å›å½’">å°±è¿‘æƒé‡çº¿æ€§å›å½’</h1>

<p>åœ¨ä¸Šé¢æå‡ºçš„åŸå§‹çš„çº¿æ€§å›å½’ç®—æ³•ä¸­ï¼Œå¦‚æœè¦æƒ³å¯¹æŸä¸ªç‚¹ <code>$x$</code> ä½œå‡ºé¢„æµ‹ï¼Œæˆ‘ä»¬è¿™ä¹ˆåšï¼š</p>

<ol>
<li>æ‰¾åˆ°ä½¿ <code>$\sum_i(y^{(i)}-\theta^Tx^{(i)})^2$</code> å–å¾—æœ€å°å€¼çš„ <code>$\theta$</code> ã€‚</li>
<li>è¾“å‡º <code>$\theta^Tx$</code> ã€‚</li>
</ol>

<p>ä¸åŒçš„æ˜¯ï¼Œå°±è¿‘æƒé‡çº¿æ€§å›å½’ç®—æ³•è¿™ä¹ˆåšï¼š</p>

<ol>
<li>æ‰¾åˆ°ä½¿ <code>$\sum_iw^{(i)}(y^{(i)}-\theta^Tx^{(i)})^2$</code> å–å¾—æœ€å°å€¼çš„ <code>$\theta$</code> ã€‚</li>
<li>è¾“å‡º <code>$\theta^Tx$</code> ã€‚</li>
</ol>

<p>è¿™é‡Œçš„ <code>$w^{(i)}$</code> æ˜¯ä¸€ç»„éè´Ÿæ•°çš„ <code>æƒé‡</code> ã€‚å¦‚æœå¯¹æŸ <code>$i$</code> è€Œè¨€ <code>$w^{(i)}$</code> çš„å€¼å¾ˆå¤§ï¼Œé‚£ä¹ˆåœ¨è®¡ç®— <code>$\theta$</code> çš„æ—¶å€™è¿™ä¸€é¡¹å çš„æˆåˆ†å°±å¾ˆå¤§ï¼Œåä¹‹åˆ™ä¼šå¯¹ <code>$\theta$</code> çš„å½±å“å°±ä¼šå¾ˆå°ã€‚</p>

<p>ä¸€ä¸ªæ¯”è¾ƒæ ‡å‡†çš„é€‰æ‹©æƒé‡çš„å‡½æ•°æ˜¯ï¼š</p>

<p><code>$$w^{(i)}=\exp(-\frac{(x^{(i)}-x)^2}{2\tau^2})$$</code></p>

<p>å…¶ä¸­çš„ <code>$\tau$</code> æ§åˆ¶äº†é‡è¦æƒé‡çš„èŒƒå›´ï¼Œæ‰€ä»¥å«åš <code>å¸¦å®½</code> (bandwidth) å‚æ•°ï¼Œé€šå¸¸é€šè¿‡å®éªŒå¾—å‡ºã€‚</p>

<p>å°±è¿‘æƒé‡çº¿æ€§å›å½’æ˜¯ä¸€ç§ <code>éå‚æ•°ç®—æ³•</code> ï¼Œè€Œæ™®é€šçš„çº¿æ€§å›å½’æ˜¯ä¸€ç§ <code>å‚æ•°ç®—æ³•</code> ã€‚å‰è€…ä¸å­˜å‚¨ <code>$\theta$</code> çš„å€¼ï¼Œè€Œæ˜¯æ¯æ¬¡é¢„æµ‹æ—¶éƒ½è¦è®¡ç®—ï¼Œåè€…åˆ™æ˜¯åªè®¡ç®—ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚</p>

                </section>
            </article>
            

            

            <ul id="post-list" class="archive readmore">
    <h3>Read more</h3>
    
    
        
        <li>
            <a href="https://knightf.github.io/post/reinforcement-learning-and-control/">æœºå™¨å­¦ä¹  ç¬¬åä¸‰ç«  å¼ºåŒ–å­¦ä¹ ä¸æ§åˆ¶<aside class="dates">Jul 4</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/independent-components-analysis/">æœºå™¨å­¦ä¹  ç¬¬åäºŒç«  ç‹¬ç«‹æˆåˆ†åˆ†æ<aside class="dates">Jun 2</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/principal-components-analysis/">æœºå™¨å­¦ä¹  ç¬¬åä¸€ç«  ä¸»æˆåˆ†åˆ†æ<aside class="dates">Jun 1</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/factor-analysis/">æœºå™¨å­¦ä¹  ç¬¬åç«  å› å­åˆ†æ<aside class="dates">May 31</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/the-em-algorithm/">æœºå™¨å­¦ä¹  ç¬¬ä¹ç«  EM ç®—æ³•<aside class="dates">May 18</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/the-perceptron-and-k-means/">æœºå™¨å­¦ä¹  ç¬¬å…«ç«  åœ¨çº¿å­¦ä¹ ä¸K-meansç®—æ³•<aside class="dates">May 12</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/regularization-and-model-selection/">æœºå™¨å­¦ä¹  ç¬¬ä¸ƒç«  ä¸€èˆ¬åŒ–ä¸æ¨¡å‹é€‰æ‹©<aside class="dates">Apr 28</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/learning-theory/">æœºå™¨å­¦ä¹  ç¬¬å…­ç«  æœºå™¨å­¦ä¹ ç†è®º<aside class="dates">Mar 24</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/support-vector-machine/">æœºå™¨å­¦ä¹  ç¬¬äº”ç«  æ”¯æŒå‘é‡æœº<aside class="dates">Mar 10</aside></a>
        </li>
        
   
    
        
        <li>
            <a href="https://knightf.github.io/post/generative-learning-algorithms/">æœºå™¨å­¦ä¹  ç¬¬å››ç«  ç”Ÿæˆå­¦ä¹ ç®—æ³•<aside class="dates">Mar 7</aside></a>
        </li>
        
   
</ul>
            <footer id="footer">
    
        <div id="social">

	
	
    
    <a class="symbol" href="mailto:knightf@live.cn">
        circleemail
    </a>
    
    <a class="symbol" href="https://github.com/knightf">
        circlegithub
    </a>
    
    <a class="symbol" href="https://twitter.com/Errrrrrrrrrric">
        circletwitterbird
    </a>
    


</div>

    
    <p class="small">
    
        Â© Copyright 2017 éŸ©é£
    
    </p>
</footer>

        </section>

        <script src="//cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
<script src="https://knightf.github.io/js/main.js"></script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script src="//cdn.bootcss.com/highlight.js/9.4.0/highlight.min.js"></script>
<script >hljs.initHighlightingOnLoad();</script>  


    </body>
</html>
